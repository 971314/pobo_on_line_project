function sendRegOTP(){var e=$.trim($("#phone").val());if(isPhoneNum(e)){if($("#btn-send")[0]){var r=(new Date).getTime(),n=pbEngine.getPrivateData("sendOTPTime");if(n){var a=r-n;if(a>12e4)sendOTPBtn(120),pbEngine.storePrivateData("sendOTPTime",r+""),$.ajax({type:"POST",url:serverAddr+"firstregister",data:{poboNumber:poboNumber,loginName:e,loginType:loginType,deviceId:deviceId,pwd:"",FatherAccount:FatherAccount,OS:OS,version:version,orgNumber:orgNumber},dataType:"json",success:function(r){0==r.loginUser.returnFlag?($(".error").addClass("hide"),$(".registered").addClass("hide")):1==r.loginUser.returnFlag||6==r.loginUser.returnFlag?($(".registered").addClass("hide"),alert("发送失败，请稍后重试")):5==r.loginUser.returnFlag?($(".error").addClass("hide").empty(),$(".registered").removeClass("hide"),$(".registered a").attr("href","password.html?phone="+e)):($(".registered").addClass("hide"),alert("连接超时，请检查网络后重试"))},error:function(){$(".registered").addClass("hide"),alert("连接超时，请检查网络后重试")}});else var i=120-Math.round(a/1e3),d=setInterval(function(){return 0==i?($("#btn-send").removeClass("disabled"),$("#btn-send").val("获取校验码"),void clearInterval(d)):($("#btn-send").val("("+i+"S)"),$("#btn-send").addClass("disabled"),void i--)},1e3)}else sendOTPBtn(120),pbEngine.storePrivateData("sendOTPTime",r+""),$.ajax({type:"POST",url:serverAddr+"firstregister",data:{poboNumber:poboNumber,loginName:e,loginType:loginType,deviceId:deviceId,pwd:"",FatherAccount:FatherAccount,OS:OS,version:version,orgNumber:orgNumber},dataType:"json",success:function(r){0==r.loginUser.returnFlag?($(".error").addClass("hide"),$(".registered").addClass("hide")):1==r.loginUser.returnFlag||6==r.loginUser.returnFlag?($(".registered").addClass("hide"),alert("发送失败，请稍后重试")):5==r.loginUser.returnFlag?($(".error").addClass("hide").empty(),$(".registered").removeClass("hide"),$(".registered a").attr("href","password.html?phone="+e)):($(".registered").addClass("hide"),alert("连接超时，请检查网络后重试"))},error:function(){$(".registered").addClass("hide"),alert("连接超时，请检查网络后重试")}})}}else alert("请输入正确的手机号"),$("#phone").focus()}function sendPwdOTP(){var e=$.trim($("#phone").val());if(isPhoneNum(e)){if($("#btn-send")[0]){var r=(new Date).getTime(),n=pbEngine.getPrivateData("sendOTPTime");if(n){var a=r-n;if(a>12e4)sendOTPBtn(120),pbEngine.storePrivateData("sendOTPTime",r+""),$.ajax({type:"POST",url:serverAddr+"getOtp",data:{poboNumber:poboNumber,loginName:e,loginType:loginType,deviceId:deviceId,orgNumber:orgNumber},dataType:"json",success:function(e){0==e.findByPhone.returnFlag?($(".error").addClass("hide"),userId=e.findByPhone.userId):11==e.findByPhone.returnFlag?alert("该用户尚未注册"):1==e.findByPhone.returnFlag||6==e.findByPhone.returnFlag?alert("发送失败，请稍后重试"):alert("连接超时，请检查网络后重试")},error:function(){alert("连接超时，请检查网络后重试")}});else var i=120-Math.round(a/1e3),d=setInterval(function(){return 0==i?($("#btn-send").removeClass("disabled"),$("#btn-send").val("获取校验码"),void clearInterval(d)):($("#btn-send").val("("+i+"S)"),$("#btn-send").addClass("disabled"),void i--)},1e3)}else sendOTPBtn(120),pbEngine.storePrivateData("sendOTPTime",r+""),$.ajax({type:"POST",url:serverAddr+"getOtp",data:{poboNumber:poboNumber,loginName:e,loginType:loginType,deviceId:deviceId,orgNumber:orgNumber},dataType:"json",success:function(e){0==e.findByPhone.returnFlag?($(".error").addClass("hide"),userId=e.findByPhone.userId):11==e.findByPhone.returnFlag?alert("该用户尚未注册"):1==e.findByPhone.returnFlag||6==e.findByPhone.returnFlag?alert("发送失败，请稍后重试"):alert("连接超时，请检查网络后重试")},error:function(){alert("连接超时，请检查网络后重试")}})}}else alert("请输入正确的手机号"),$("#phone").focus()}function register(){var e=$.trim($("#phone").val()),r=$.trim($("#code").val()),n=$.trim($("#pwdInit").val()),a=$.trim($("#confirm").val());if(isPhoneNum(e)){if(isNull(r))return alert("请输入验证码"),$("#code").focus(),!1;if(isNull(n))return alert("请输入密码"),$("#pwdInit").focus(),!1;if(!isRightPwd(n))return alert("密码是6-16位字母和数字的组合"),$("#pwdInit").focus(),!1;if(isNull(a))return alert("请输入确认密码"),$("#confirm").focus(),!1;if(a!=n)return alert("两次输入密码不一致"),$("#confirm").focus(),!1;$("#backdrop").removeClass("hide"),$.ajax({type:"POST",url:serverAddr+"checkRegister",data:{poboNumber:poboNumber,loginName:e,loginType:loginType,OTP:r,deviceId:deviceId,pwd:n,orgNumber:orgNumber},dataType:"json",success:function(r){$("#backdrop").addClass("hide"),0==r.checkOTP.returnFlag?($(".error").addClass("hide"),$(".registered").addClass("hide"),delete r.checkOTP.returnFlag,r.checkOTP.pwd=e.substr(-6),r.checkOTP.loginName=e,r.checkOTP.loginType=loginType,pbEngine.sendMessageToNative("PbKey_H5_Home_Auth_Data",JSON.stringify(r.checkOTP))):1==r.checkOTP.returnFlag?($(".registered").addClass("hide"),alert("注册失败，请稍后重试")):5==r.checkOTP.returnFlag?($(".error").addClass("hide").empty(),$(".registered").removeClass("hide"),$(".registered a").attr("href","password.html?phone="+e)):8==r.checkOTP.returnFlag?($(".registered").addClass("hide"),alert("校验码错误，请重新获取")):($(".registered").addClass("hide"),alert("连接超时，请检查网络后重试"))},error:function(){$("#backdrop").addClass("hide"),$(".registered").addClass("hide"),alert("连接超时，请检查网络后重试")}})}else alert("请输入正确的手机号"),$("#phone").focus()}function setPwd(){var e=$.trim($("#phone").val()),r=$.trim($("#code").val()),n=$.trim($("#password").val()),a=$.trim($("#confirm").val());if(isPhoneNum(e)){if(isNull(r))return alert("请请输入验证码"),$("#code").focus(),!1;if(isNull(n))return alert("请输入密码"),$("#password").focus(),!1;if(!isRightPwd(n))return alert("密码是6-16位字母和数字的组合"),$("#password").focus(),!1;if(isNull(a))return alert("请输入确认密码"),$("#confirm").focus(),!1;if(a!=n)return alert("两次输入密码不一致"),$("#confirm").focus(),!1;$("#backdrop").removeClass("hide"),$.ajax({type:"POST",url:serverAddr+"changePwd",data:{poboNumber:poboNumber,loginName:e,loginType:loginType,pwd:n,uid:userId,orgNumber:orgNumber,deviceId:deviceId,OS:OS,version:version,OTP:r},dataType:"json",success:function(r){$("#backdrop").addClass("hide"),0==r.loginUser.returnFlag?($(".error").addClass("hide"),delete r.loginUser.returnFlag,r.loginUser.pwd=n,r.loginUser.loginName=e,r.loginUser.loginType=loginType,pbEngine.sendMessageToNative("PbKey_H5_Home_Auth_Data",JSON.stringify(r.loginUser))):1==r.loginUser.returnFlag?alert("设置失败，请稍后重试"):8==r.loginUser.returnFlag?alert("校验码错误，请重新获取"):11==r.loginUser.returnFlag?alert("该用户尚未注册"):alert("连接超时，请检查网络后重试")},error:function(){$("#backdrop").addClass("hide"),alert("连接超时，请检查网络后重试")}})}else alert("请输入正确的手机号"),$("#phone").focus()}function login(){var e=$.trim($("#phone").val()),r=$.trim($("#password").val());if(isPhoneNum(e)){if(isNull(r))return alert("请输入密码"),$("#password").focus(),!1;$("#backdrop").removeClass("hide"),$.ajax({type:"POST",url:serverAddr+"login",data:{poboNumber:poboNumber,loginName:e,loginType:loginType,pwd:r,orgNumber:orgNumber,deviceId:deviceId,OS:OS,version:version},dataType:"json",success:function(n){$("#backdrop").addClass("hide"),0==n.loginUser.returnFlag?($(".error").addClass("hide"),delete n.loginUser.returnFlag,n.loginUser.pwd=r,n.loginUser.loginName=e,n.loginUser.loginType=loginType,pbEngine.sendMessageToNative("PbKey_H5_Home_Auth_Data",JSON.stringify(n.loginUser))):1==n.loginUser.returnFlag?(alert("登录失败，请稍后重试"),$("#phone").focus()):2==n.loginUser.returnFlag?(alert("账号或密码有误，请修改后重试"),$("#phone").focus()):alert("连接超时，请检查网络后重试")},error:function(){$("#backdrop").addClass("hide"),alert("连接超时，请检查网络后重试")}})}else alert("请输入正确的手机号"),$("#phone").focus()}function jump(e){var r=document.getElementById(e),n=arguments.callee.caller.arguments[0]||window.event;13==n.keyCode&&r.focus()}function fold(){$("input").blur()}var serverAddr="https://pbmobile.pobo.net.cn/pobocertification_WebService/",loginType="1",userId,poboNumber="123",deviceId="127.0.0.1",FatherAccount="pobo",OS="iOS",version="1.0.0",orgNumber="789",deviceInfo1=pbEngine.getDeviceJsonInfo();if(deviceInfo1){var deviceInfo=JSON.parse(deviceInfo1);if(deviceInfo[71]&&(deviceId=deviceInfo[71]),deviceInfo[255]){var platNum=deviceInfo[255];"2"==platNum?OS="iOS":"3"==platNum&&(OS="Android")}deviceInfo[73]&&(version=deviceInfo[73]),deviceInfo.jgid&&(orgNumber=deviceInfo.jgid)}