function decimalDec(o,i){i+="";var t=i.indexOf("."),e=i.length;return i=t>=0&&e-1-t>=o+1?i.substr(0,i.indexOf(".")+o+2):(i-0).toFixed(o+1)}function decimalDecPrice(o,i){i+="";var t=i.indexOf("."),e=i.length;return i=t>=0&&e-1-t>=o?i.substr(0,i.indexOf(".")+o+1):(i-0).toFixed(o)}function tradePart(o){var i=pbE.WT().wtQueryStockRe(o);if(i)if(position=JSON.parse(i).data,position.length>0){var t={},e=[],a=[];marketInfo=[];for(var s=0;s<position.length;s++){position[s].flag=0;var n=position[s][54],r=position[s][63],p=0;marketInfo=JSON.parse(pbE.WT().wtGetHQInfo(r,n)),r.indexOf("&")>=0&&(p=1),marketInfo.HQCode&&marketInfo.HQMarket&&!isNaN(position[s][136])&&!p||(position[s].flag=1);var l=pbE.HQ().hqGetPriceRate(marketInfo.HQCode,marketInfo.HQMarket),f=pbE.WT().wtGetMSSL(r,n);position[s][2]=position[s][136]-0,position[s][3]=position[s][135]-0,position[s][4]=l,position[s][5]=f,a.indexOf(marketInfo.HQCode)<0&&(a.push(marketInfo.HQCode),e.push({2:marketInfo.HQMarket,3:marketInfo.HQCode})),position[s].name=marketInfo.HQName||"",position[s].market=marketInfo.HQMarket,position[s].code=marketInfo.HQCode,position[s].groupflag=pbE.HQ().hqGetGroupFlag(marketInfo.HQCode,marketInfo.HQMarket),position[s].decimal=pbE.HQ().hqGetPriceDecimal(marketInfo.HQCode,marketInfo.HQMarket),position[s][136]=decimalDec(position[s].decimal,position[s][136]),position[s].available=position[s][137],position[s].flag?position[s].flag&&(position[s].profit="--",position[s].price="--"):(position[s].price=pbE.HQ().hqGetNowPrice(marketInfo.HQCode,marketInfo.HQMarket),position[s].base=pbE.HQ().hqGetLastBasePrice(marketInfo.HQCode,marketInfo.HQMarket),position[s].price&&!isNaN(position[s].price)?(position[s].profit=((position[s].price-position[s][136]-0).toFixed(4)-0)*position[s][135]*f,"1"==position[s][112]&&(position[s].profit=0-position[s].profit),position[s].profit=(position[s].profit-0).toFixed(2)):position[s].base&&!isNaN(position[s].base)&&(position[s].profit=((position[s].base-position[s][136]-0).toFixed(4)-0)*position[s][135]*f,"1"==position[s][112]&&(position[s].profit=0-position[s].profit),position[s].profit=(position[s].profit-0).toFixed(2),position[s].price="--"),calcProfit(position,s,f))}position.sort(firstBy(function(o){return o[63].toUpperCase()}).thenBy("112").thenBy("503")),ReactDOM.render(React.createElement(PositionContentsFutures,{contents:position}),document.getElementById("contents"));var c=!1;totalPL=0,sumPl=0;for(var s=0,d=position.length;s<d;s++)"undefined"==typeof position[s].dayPl||isNaN(position[s].dayPl)?position[s].flag:(totalPL+=position[s].dayPl-0,c=!0);c&&(plFlag=1,close&&(closePl-=0,totalPL-=0,sumPl=(closePl+totalPL-0).toFixed(2),$("#float").html(sumPl+"元"))),t[1]=e,t[7]="1",pbE.HQ().hqSubscribe(0,JSON.stringify(t))}else position.length<=0&&(pbE.SYS().stopLoading(),plFlag=1,totalPL=0,$("#contents").empty(),closePl&&$("#float").html((closePl-0).toFixed(2)+"元"))}function calcProfit(o,i,t){var e=o[i];"1"==e[503]?e.price&&!isNaN(e.price)&&"--"!=e.price?(e.dayPl=((e.price-e[136]-0).toFixed(4)-0)*e[135]*t,"1"==e[112]&&(e.dayPl=0-e.dayPl)):"--"==e.price&&(e.dayPl=0):"2"==e[503]?e.price&&!isNaN(e.price)&&"--"!=e.price&&e.base&&!isNaN(e.base)?(e.dayPl=((e.price-e.base-0).toFixed(4)-0)*e[135]*t,"1"==e[112]&&(e.dayPl=0-e.dayPl)):"--"==e.price&&(e.dayPl=0):"0"==e[503]&&(e[1101]==e[135]?e.price&&!isNaN(e.price)&&"--"!=e.price?(e.dayPl=((e.price-e[1102]-0).toFixed(4)-0)*e[1101]*t,"1"==e[112]&&(e.dayPl=0-e.dayPl)):"--"==e.price&&(e.dayPl=0):e[1101]<e[135]&&(e.price&&!isNaN(e.price)&&"--"!=e.price&&e.base&&!isNaN(e.base)?(e.dayPl=((e.price-e[1102]-0).toFixed(4)-0)*e[1101]*t+((e.price-e.base-0).toFixed(4)-0)*(e[135]-e[1101]-0)*t,"1"==e[112]&&(e.dayPl=0-e.dayPl)):"--"==e.price&&(e.dayPl=0)))}function hqPart(o){hasSubscribe=!0;for(var i=o.jData.Data,t=0,e=0,a=0,s=position.length;a<s;a++)if(position[a].flag)position[a].flag&&(position[a].profit="--",position[a].price="--");else for(var n=0,r=i.length;n<r;n++){position[a].code==i[n][10]&&(position[a].base=pbE.HQ().hqGetLastBasePrice(position[a].code,position[a].market),i[n][29]&&!isNaN(i[n][29])?(t=(i[n][29]-0)/position[a][4],e=((t-position[a][2]).toFixed(4)-0)*position[a][3]*position[a][5],"1"==position[a][112]&&(e=0-e),t=decimalDecPrice(position[a].decimal,t),position[a][7]=e,position[a].profit=e,position[a].price=t,position[a].profit=(position[a].profit-0).toFixed(2),calcProfit(position,a,position[a][5])):(position[a].dayPl=0,position[a].price="--",position[a].base&&!isNaN(position[a].base)?(position[a].profit=((position[a].base-position[a][136]-0).toFixed(4)-0)*position[a][135]*position[a][5],"1"==position[a][112]&&(position[a].profit=0-position[a].profit),position[a].profit=(position[a].profit-0).toFixed(2)):position[a].profit="--"),setPrice(position[a]));break}var l=!1;totalPL=0,sumPl=0;for(var a=0,s=position.length;a<s;a++)"undefined"==typeof position[a].dayPl||isNaN(position[a].dayPl)?position[a].flag:(totalPL+=position[a].dayPl-0,l=!0);l&&(plFlag=1,p++,close&&(sumPl=(totalPL-0+(closePl-0)-0).toFixed(2),1==p&&pbE.SYS().stopLoading()),sumPl&&0!=sumPl&&$("#float").html(sumPl+"元"))}function setPrice(o){var i="#"+o.code+"_"+o[112]+"_"+o[503];isNaN(o.profit)?($(i).removeClass("redbar"),$(i).removeClass("greenbar"),$(i+" .profit").html(o.profit),$(i+" .profit").removeClass("a3").removeClass("a4").addClass("a1")):o.profit>0?($(i).removeClass("greenbar"),$(i).addClass("redbar"),$(i+" .profit").removeClass("a1").removeClass("a4").addClass("a3"),$(i+" .profit").html("+"+o.profit)):o.profit<0?($(i).removeClass("redbar"),$(i).addClass("greenbar"),$(i+" .profit").removeClass("a1").removeClass("a3").addClass("a4"),$(i+" .profit").html(o.profit)):0==o.profit&&($(i).removeClass("redbar"),$(i).removeClass("greenbar"),$(i+" .profit").html(o.profit),$(i+" .profit").removeClass("a3").removeClass("a4").addClass("a1")),$(i+" .price").html(o.price)}"undefined"==typeof pbE&&(window.pbE={WT:function(){var o={wtGetCurrentConnectionCID:function(){},wtQueryMoney:function(){},wtQueryMoneyRe:function(){var o={moduleId:90002,functionNO:6012,jData:{data:[{102:10,182:20,97:30,152:111,111:10,63:"GTF"}]}};callback(JSON.stringify(o)),$("#float").html("1026元")},wtQueryStockRe:function(){}};return o},SYS:function(){var o={startLoading:function(){}};return o}});var marketInfo,totalPL,position,stockInfo=[],p=0,asset,refreshFlag=1,CID=pbE.WT().wtGetCurrentConnectionCID(),closePl,sumPl,close=0,plFlag=0;$(function(){var o={callbacks:[{fun:6012,module:90002,callback:function(o){if(asset=o.jData.data[0],close=1,closePl=asset[102]-0,asset[97]=(asset[97]-0).toFixed(2),asset[152]=(asset[152]-0).toFixed(2),asset[111]=(asset[111]-0).toFixed(2),plFlag)asset.sumPl=(totalPL-0+(closePl-0)-0).toFixed(2);else{var i=$("#float").html();asset.sumPl=i.substring(0,i.length-1)}ReactDOM.render(React.createElement(FundsInfoFutures,{info:asset}),document.getElementById("fund"))}},{fun:56004,module:90002,callback:function(o){o.reservId==CID&&5==o.jData[223]&&(refreshFlag||(pbE.SYS().stopLoading(),refreshFlag=1),fresh())}},{fun:56005,module:90002,callback:function(o){o.reservId==CID&&pbPage.fresh()}},{fun:56006,module:90002,callback:function(o){o.reservId==CID&&pbPage.fresh()}},{fun:56014,module:90002,callback:function(o){o.reservId==CID&&pbPage.fresh()}},{module:9e4,callback:function(o){totalPL=0,hqPart(o)}}],reload:function(){close=0,plFlag=0,CID=pbE.WT().wtGetCurrentConnectionCID(),p=0,tradePart(CID),pbE.WT().wtQueryMoney(CID,JSON.stringify({}))},refresh:function(){close=0,plFlag=0,pbE.SYS().startLoading(),refreshFlag=0,pbE.WT().wtQueryMoney(CID,JSON.stringify({})),pbE.WT().wtSynFlash(CID)},fresh:function(){close=0,plFlag=0,p=0,tradePart(CID),pbE.WT().wtQueryMoney(CID,JSON.stringify({}))},doShow:function(o){o||pbE.SYS().stopLoading()}};pbPage.initPage(o);var i=pbE.WT().wtQueryMoneyRe(CID);if(i){var t=JSON.parse(i).data[0];t[97]=(t[97]-0).toFixed(2),t[152]=(t[152]-0).toFixed(2),t[111]=(t[111]-0).toFixed(2),t.sumPl="--",ReactDOM.render(React.createElement(FundsInfoFutures,{info:t}),document.getElementById("fund"))}p=0,pbE.SYS().startLoading(),tradePart(CID,!0),pbE.WT().wtQueryMoney(CID,JSON.stringify({}))});