define("futures/scripts/forgetPassword/findPassword2.js",function(e,t,o){function n(){if(_=$.getPageParam("mobile"),j&&(u=pbE.HQ(),f=pbE.SYS(),v=pbE.ZX(),p=pbE.INFO()),"undefined"!=typeof pbE){var e=pbE.SYS().getDeviceJsonInfo();if(e){var t=JSON.parse(e);if(t[71]&&(T=t[71]),t[255]){var o=t[255];"2"==o?N="iOS":"3"==o&&(N="Android")}t[73]&&(O=t[73]),t.jgid&&(U=t.jgid)}}$.validatorUtils.isEmpty(_)&&$(c+" #get_code").attr("class","code_btn1")}function r(){$.bindEvent($(c+" .icon_back"),function(){window.location.href="goBack"}),$.bindEvent($(c+" .code_btn"),function(){var e=_;$.ajax({type:"POST",url:E+"getOtp",data:{poboNumber:S,loginName:e,loginType:P,deviceId:T,orgNumber:U},dataType:"json",success:function(e){0==e.findByPhone.returnFlag&&(alert("发送成功"),g=e.findByPhone.userId,I=60,i($(c+" .code_btn")))},error:function(){alert("连接超时，请检查网络后重试")}})}),$.bindEvent($(c+" #reset_btn"),function(){if($.validatorUtils.isEmpty($.trim($(c+" #message_code").val())))return void alert("短信验证码不能为空");if($.trim($(c+" #message_code").val()).length<4)return void alert("短信验证码不正确");var e=$.trim($(c+" #password").val()),t=$.trim($(c+" #reset_password").val());if(e.length<7&&e.length>20)return void alert("密码必须是8-20位字母和数字的组合");if(e.length<8||e.length>20)return 0==e.length?void alert("密码不能为空"):void alert("密码必须是8-20位字母和数字的组合");for(var o=0,n=0;n<e.length;n++)if(e[n].match(/^[a-zA-z]+$/)){o+=1;break}for(var n=0;n<e.length;n++)if(e[n].match(/^\d+$/)){o+=1;break}if(2!=o)return void alert("登录密码只能是数字和字母组合");if(e==t){var r={login_password:e,login_password_twice:t};a(r)}else alert("两次密码不一致")})}function i(e){return 0==I?(e.text("获取验证码"),void e.attr("class","code_btn")):(e.attr("class","code_btn1"),e.text("重新发送("+I+")"),I--,void(m=setTimeout(function(){i(e)},1e3)))}function a(e){var t=_,o=$.trim($("#message_code").val()),n=e.login_password;e.login_password_twice;$.ajax({type:"POST",url:E+"changePwd",data:{poboNumber:S,loginName:t,loginType:P,pwd:n,uid:g,orgNumber:U,deviceId:T,OS:N,version:O,OTP:o},dataType:"json",success:function(o){0==o.loginUser.returnFlag?(o.loginUser.pwd=n,o.loginUser.loginName=t,o.loginUser.loginType=P,b=o.loginUser,w.rsaEncrypt(e,function(e){var t={mobile_phone:_,login_password:e.login_password,login_password_twice:e.login_password_twice};y.resetPassword(t,function(e){0==e.error_no?"Android"==h.getEquipmentType()?(setTimeout(function(){pbE.SYS().sendMessageToNative("PbKey_H5_Home_Auth_Data",JSON.stringify(b))},1e3),window.open("pobo:uncheck=1&pageId=900005&url=main/futures/views/login.html"),window.location.href="close"):window.location.href="pobo:uncheck=1&pageId=900005&url=main/futures/views/login.html":alert(e.error_info)})})):8==o.loginUser.returnFlag?alert("校验码错误，请重新获取"):11==o.loginUser.returnFlag?alert("该用户尚未注册"):alert("发送失败，请稍后重试")},error:function(){alert("连接超时，请检查网络后重试")}})}function s(){$(c+" #get_code").attr("class","code_btn"),$(c+" .code_btn").text("获取验证码"),$(c+" .code_btn").attr("class","code_btn"),clearTimeout(m)}function d(){}function l(){}var c="#forgetPassword_findPassword2 ";e("2.0.0/js/plugins/validator/scripts/validatorUtils");var g,u,f,p,v,b,_,m,w=e("commonExt"),h=e("common"),y=e("futures/services/userService").getInstance(),E="https://pbmobile.pobo.net.cn/pobocertification_WebService/",P="1",S="123",T="127.0.0.1",N="iOS",O="1.0.0",U="789",j="undefined"!=typeof pbE,I=60,k={init:n,bindPageEvent:r,destroy:s,pageBack:d,load:l};o.exports=k});