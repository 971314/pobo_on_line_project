define("futures/scripts/forgetPassword/findPassword1.js",function(e,t,i){function n(){if(x&&(_=pbE.HQ(),b=pbE.SYS(),w=pbE.ZX(),m=pbE.INFO()),"undefined"!=typeof pbE){var e=pbE.SYS().getDeviceJsonInfo();if(e){var t=JSON.parse(e);if(t[71]&&(T=t[71]),t[255]){var i=t[255];"2"==i?N="iOS":"3"==i&&(N="Android")}t[73]&&(O=t[73]),t.jgid&&(j=t.jgid)}}s()}function r(){$.bindEvent($(v+" .icon_back"),function(){window.location.href="goBack"}),$.bindEvent($(v+" .rounded"),function(){o()&&a()}),$.bindEvent($(v+" #find_captcha_img"),function(){s()}),$.bindEvent($(v+" .code_btn"),function(){var e=$.trim($(v+"#find_mobile").val());$.ajax({type:"POST",url:k+"getOtp",data:{poboNumber:U,loginName:e,loginType:S,deviceId:T,orgNumber:j},dataType:"json",success:function(e){0==e.findByPhone.returnFlag&&(alert("发送成功"),p=e.findByPhone.userId,I=60,d($(v+" .code_btn")))},error:function(){alert("连接超时，请检查网络后重试")}})}),$.bindEvent($(v+" #reset_btn"),function(){if($.validatorUtils.isEmpty($.trim($(v+" #message_code").val())))return void alert("短信验证码不能为空");if($.trim($(v+" #message_code").val()).length<4)return void alert("短信验证码不正确");var e=$.trim($(v+" #password").val()),t=$.trim($(v+" #reset_password").val());if(e.length<7&&e.length>20)return void alert("密码必须是8-20位字母和数字的组合");if(e.length<8||e.length>20)return 0==e.length?void alert("密码不能为空"):void alert("密码必须是8-20位字母和数字的组合");for(var i=0,n=0;n<e.length;n++)if(e[n].match(/^[a-zA-z]+$/)){i+=1;break}for(var n=0;n<e.length;n++)if(e[n].match(/^\d+$/)){i+=1;break}if(2!=i)return void alert("登录密码只能是数字和字母组合");if(e==t){var r={login_password:e,login_password_twice:t};c(r)}else alert("两次密码不一致")})}function o(){var e=$.trim($(v+"#find_mobile").val()),t=$.trim($(v+"#find_check_code").val());return $.validatorUtils.isEmpty(e)||!$.validatorUtils.isMobile(e)?(alert("请输入正确的手机号"),!1):!$.validatorUtils.isEmpty(t)||(alert("图形验证码不能为空"),!1)}function a(){var e={mobile_phone:$.trim($(v+"#find_mobile").val()),type:"1"};E.CheckPhoneNumber(e,function(e){if("0"==e.error_no){var t=e.results;"0"==t[0].is_exist?(s(),alert("该手机号码未注册，请使用其他号码")):l()}})}function s(){$(v+"#find_captcha_img").attr("src",$.config.global.imagePath+"?r="+(new Date).getTime())}function l(){var e=$.trim($(v+"#find_check_code").val());E.CheckGraphicalCode({ticket:e},function(e){"0"==e.error_no?($(v+" #findPwd1").css("display","none"),$(v+" #findPwd2").css("display","block")):(alert(e.error_info),s())})}function d(e){return 0==I?(e.text("获取验证码"),void e.attr("class","code_btn")):(e.attr("class","code_btn1"),e.text("重新发送("+I+")"),I--,void(y=setTimeout(function(){d(e)},1e3)))}function c(e){var t=$.trim($(v+"#find_mobile").val()),i=$.trim($("#message_code").val()),n=e.login_password;e.login_password_twice;$.ajax({type:"POST",url:k+"changePwd",data:{poboNumber:U,loginName:t,loginType:S,pwd:n,uid:p,orgNumber:j,deviceId:T,OS:N,version:O,OTP:i},dataType:"json",success:function(i){0==i.loginUser.returnFlag?(i.loginUser.pwd=n,i.loginUser.loginName=t,i.loginUser.loginType=S,h=i.loginUser,P.rsaEncrypt(e,function(e){var t={mobile_phone:$.trim($(v+"#find_mobile").val()),login_password:e.login_password,login_password_twice:e.login_password_twice};E.resetPassword(t,function(e){0==e.error_no?window.location.href="goBack":alert(e.error_info)})})):8==i.loginUser.returnFlag?alert("校验码错误，请重新获取"):11==i.loginUser.returnFlag?alert("该用户尚未注册"):alert("发送失败，请稍后重试")},error:function(){alert("连接超时，请检查网络后重试")}})}function f(){$(v+" #get_code").attr("class","code_btn"),$(v+" .code_btn").text("获取验证码"),$(v+" .code_btn").attr("class","code_btn"),clearTimeout(y)}function u(){}function g(){}var v="#forgetPassword_findPassword1 ";e("2.0.0/js/plugins/validator/scripts/validatorUtils");var p,_,b,m,w,h,y,E=(e("common"),e("futures/services/userService").getInstance()),P=e("commonExt"),k="https://pbmobile.pobo.net.cn/pobocertification_WebService/",S="1",U="123",T="127.0.0.1",N="iOS",O="1.0.0",j="789",x="undefined"!=typeof pbE,I=60,B={init:n,bindPageEvent:r,destroy:f,pageBack:u,load:g};i.exports=B});