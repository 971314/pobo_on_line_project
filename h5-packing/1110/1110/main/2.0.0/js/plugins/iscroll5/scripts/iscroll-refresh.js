define("2.0.0/js/plugins/iscroll5/scripts/iscroll-refresh.js",function(e,t,n){var l=e("iscroll5");$.loadCss("2.0.0/js/plugins/iscroll5/css/iscroll-refresh.css");var o=function(e,t,n){function o(){S=T.tabScroller.children;for(var e,t=0,n=0;n<S.length;n++)t+=S[n].offsetWidth,S[n].style.width=S[n].offsetWidth+"px",e=S[n].tagName;t+=1,T.tabScroller.style.width=t+"px",A=new l(T.tabWrapper,{scrollX:!0,scrollY:!1,snap:e,tap:!0});var o=T.bdWrapper.children[0];H=T.bdWrapper.offsetWidth,X=T.bdWrapper.offsetHeight;var r=o.children;for(o.style.width=H*r.length+"px",n=0;n<r.length;n++){r[n].style.width=H+"px",r[n].style.height=X+"px",r[n].children[0].style.minHeight=X+"px",G[n]=new l(r[n],{probeType:3,tap:!0});var p=document.createElement("div");p.className=O,p.innerHTML=L,r[n].appendChild(p);var u=document.createElement("div");u.className=Q,u.innerHTML=z,r[n].appendChild(u),G[n].on("scrollStart",w),G[n].on("scroll",y),G[n].on("scrollEnd",D),B[n]=!1,F[n]=!1}N=new l(T.bdWrapper,{scrollX:!0,scrollY:!1,momentum:!1,snap:!0}),N.on("scrollEnd",g),i()}function i(){for(var e=0;e<S.length;e++)S[e].addEventListener("tap",function(e){e.preventDefault();var t=e.target||e.srcElement,n=T.index(t,S);N.goToPage(parseInt(n),0,500)},!1)}function r(e,t){Z(e.scroller).animate({top:t+"px"},500)}function p(e,t){if("function"==typeof T.downTip){var n={scroll:e,index:N.currentPage.pageX,ele:c(e),tip:t};return void T.downTip(n)}c(e).querySelector(".tip b").innerHTML=t}function u(e,t){if(T.downAnimation)return{scroll:e,index:N.currentPage.pageX,ele:c(e),status:t},void T.downAnimation(param);if(0==t){var n=e.y/E*180;c(e).querySelector(".ico i").style.transform="rotate("+n+"deg)"}}function c(e){return e.wrapper.querySelector("."+O)}function a(e,t){if("function"==typeof T.upTip){var n={scroll:e,index:N.currentPage.pageX,ele:f(e),tip:t};return void T.upTip(n)}f(e).querySelector(".tip").innerHTML=t}function s(e,t){if(T.upAnimation)return{scroll:e,index:N.currentPage.pageX,ele:f(e),status:t},void T.upAnimation(param);var n=180;0==t?(f(e).querySelector(".ico").className="ico",f(e).querySelector(".ico").style.transform="rotate("+n+"deg)"):1==t?(n=0,f(e).querySelector(".ico").className="ico",f(e).querySelector(".ico").style.transform="rotate("+n+"deg)"):2==t&&(f(e).querySelector(".ico").className="ico loading")}function f(e){return e.wrapper.querySelector("."+Q)}function d(e){if(W=!0,!B[N.currentPage.pageX]){if(c(e).style.display="none",-80>k)return void(W=!1);for(var t=0;t<x.pullDown.except.length;t++)if(x.pullDown.except[t]==N.currentPage.pageX)return void(W=!1);M=e.scroller.getAttribute("noMore")?1:0;var n=(new Date).getTime();q=n,R=e.scroller.getAttribute("lastupdate")||n;var l=parseInt((n-R)/1e3);if(1===M&&l<=x.pullDown.nextTime)return void(W=!1);c(e).style.display="block",1==M&&e.scroller.setAttribute("noMore",0),p(e,x.pullDown.contentDown),W=!0;var o=new Date(parseInt(R)),i=o.getMonth()+1+"/"+o.getDate()+" "+o.getHours()+":"+o.getMinutes()+":"+o.getSeconds();c(e).querySelector(".tip i").innerHTML="最后刷新："+i}}function h(e){if(Y=!0,!F[N.currentPage.pageX]){if(f(e).style.display="none",k>e.maxScrollY+80)return void(Y=!1);for(var t=0;t<x.pullUp.except.length;t++)if(x.pullUp.except[t]==N.currentPage.pageX)return void(Y=!1);if(I=e.scroller.getAttribute("loadedAll")?1:0)return void(Y=!1);f(e).style.display="block",a(e,x.pullUp.contentUp)}}function m(){if(!V)return!1;var e=(new Date).getTime(),t=e-q;return V=!(t>200)}function g(){var e=T.pageX=this.currentPage.pageX;A.scrollToElement(T.tabScroller.children[e],700,!0),T.tabScroller.querySelector(".active").className="",T.tabScroller.children[e].className="active",T.slideAction&&T.slideAction(N.currentPage.pageX),G[N.currentPage.pageX].enable()}function w(){K=!1,J=!1,k=this.y,P=N.x,d(this),h(this)}function y(){if(!m()){if(!K&&!J){var e=Math.abs(N.x-P),t=Math.abs(this.y-k);if(e>5||t>5){if(e>t)return this.disable(),this.scrollTo(0,k),void(J=!0);N.disable(),N.goToPage(N.currentPage.pageX,0),K=!0}}if(W&&(this.y>=E&&!C&&-1==this.directionY?(C=!0,p(this,x.pullDown.contentHover),u(this,1)):this.y<E&&this.y>=0&&(1===this.directionY&&(p(this,x.pullDown.contentDown),C=!1),C?this.scroller.style.top=E-this.y+"px":u(this,0))),Y)if(this.y<=this.maxScrollY-$&&!_&&1==this.directionY)_=!0,a(this,x.pullUp.contentHover),s(this,1);else if(this.y>this.maxScrollY-$&&this.y<this.maxScrollY&&(-1===this.directionY&&(_=!1,a(this,x.pullUp.contentUp),s(this,0)),_)){var n=this.maxScrollY-this.y-$;this.scroller.style.top=n+"px"}}}function D(){N.enable();var e=this;if(C){p(e,x.pullDown.contentRefresh),u(this,2);var t=e.scroller.getAttribute("lastupdate");t||(t=0);var n={scroll:e,index:N.currentPage.pageX,lastUpdate:parseInt(t)};B[n.index]=!0,b(n)}else if(_){a(e,x.pullUp.contentRefresh),s(e,2);var t=e.scroller.getAttribute("lastupdate");t||(t=0);var l=e.scroller.getAttribute("page");l||(l=0);var n={scroll:e,index:N.currentPage.pageX,lastUpdate:parseInt(t),page:parseInt(l)};F[n.index]=!0,v(n)}}function v(e){"function"==typeof T.upAction?T.upAction(e):setTimeout(function(){T.pullUpCallBack(e,1)},1e3)}function b(e){"function"==typeof T.downAction?T.downAction(e):setTimeout(function(){T.pullDownCallBack(e,1)},1e3)}function U(e,t,n){x.tabs=e,x.tabs_bd=t,T.tabWrapper="string"==typeof e?document.querySelector(e):e,T.tabScroller=T.tabWrapper.children[0],T.bdWrapper="string"==typeof t?document.querySelector(t):t,T.bdScroller=T.bdWrapper.children[0],"undefined"!=typeof n&&("undefined"!=typeof n.pullDown&&(x.pullDown.height="undefined"!=typeof n.pullDown.height?n.pullDown.height:x.pullDown.height,x.pullDown.nextTime="undefined"!=typeof n.pullDown.nextTime?n.pullDown.nextTime:x.pullDown.nextTime,x.pullDown.html="undefined"!=typeof n.pullDown.html?n.pullDown.html:x.pullDown.html,x.pullDown.except="undefined"!=typeof n.pullDown.except?n.pullDown.except:x.pullDown.except,x.pullDown.contentDown="undefined"!=typeof n.pullDown.contentDown?n.pullDown.contentDown:x.pullDown.contentDown,x.pullDown.contentHover="undefined"!=typeof n.pullDown.contentHover?n.pullDown.contentHover:x.pullDown.contentHover,x.pullDown.contentRefresh="undefined"!=typeof n.pullDown.contentRefresh?n.pullDown.contentRefresh:x.pullDown.contentRefresh,x.pullDown.contentNomore="undefined"!=typeof n.pullDown.contentNomore?n.pullDown.contentNomore:x.pullDown.contentNomore,x.pullDown.callback="undefined"!=typeof n.pullDown.callback?n.pullDown.callback:x.pullDown.callback,x.pullDown.animation="undefined"!=typeof n.pullDown.animation?n.pullDown.animation:x.pullDown.animation),"undefined"!=typeof n.pullUp&&(x.pullUp.height="undefined"!=typeof n.pullUp.height?n.pullUp.height:x.pullUp.height,x.pullUp.nextTime="undefined"!=typeof n.pullUp.nextTime?n.pullUp.nextTime:x.pullUp.nextTime,x.pullUp.html="undefined"!=typeof n.pullUp.html?n.pullUp.html:x.pullUp.html,x.pullUp.except="undefined"!=typeof n.pullUp.except?n.pullUp.except:x.pullUp.except,x.pullUp.contentUp="undefined"!=typeof n.pullUp.contentUp?n.pullUp.contentUp:x.pullUp.contentUp,x.pullUp.contentHover="undefined"!=typeof n.pullUp.contentHover?n.pullUp.contentHover:x.pullUp.contentHover,x.pullUp.contentRefresh="undefined"!=typeof n.pullUp.contentRefresh?n.pullUp.contentRefresh:x.pullUp.contentRefresh,x.pullUp.contentNomore="undefined"!=typeof n.pullUp.contentNomore?n.pullUp.contentNomore:x.pullUp.contentNomore,x.pullUp.callback="undefined"!=typeof n.pullUp.callback?n.pullUp.callback:x.pullUp.callback,x.pullUp.animation="undefined"!=typeof n.pullUp.animation?n.pullUp.animation:x.pullUp.animation)),o()}var x={pullDown:{height:60,nextTime:3600,html:'<span class="ico"><i></i></span><span class="tip"><b>下拉刷新...</b><i></i></span>',except:[],contentDown:"下拉刷新...",contentHover:"释放立即刷新...",contentRefresh:"正在刷新...",contentNomore:"没有更多新数据了...",callback:null,animation:null,tip:null},pullUp:{height:40,html:'<span class="ico"></span><span class="tip">上拉加载更多</span>',except:[],contentUp:"上拉加载更多...",contentHover:"释放立即加载...",contentRefresh:"正在加载...",contentNomore:"没有更多数据了...",callback:null,animation:null,tip:null},tabs:"tabs",tabs_bd:"tabs-bd",slide:null},T=this;T.pageX=0;var A,S,N,H,X,k,P,q,M,R,W,Y,I,C=!1,E=x.pullDown.height,L=x.pullDown.html,B=[],_=!1,$=x.pullUp.height,z=x.pullUp.html,F=[],G=[],J=!1,K=!1,O="ir-down-tip",Q="ir-up-tip";T.index=function(e,t){for(var n=0;n<t.length;n++)if(t[n]==e)return n};var V=!0;this.pullDownCallBack=function(e,t){var n=e.scroll;C=!1,B[e.index]=!1,"undefined"!=typeof t?(n.scroller.setAttribute("noMore","1"),p(n,x.pullDown.contentNomore),u(n,3),setTimeout(function(){r(n,0),n.refresh()},1e3)):setTimeout(function(){p(n,x.pullDown.contentDown),u(n,0),r(n,0),n.refresh()},1e3);var l=(new Date).getTime();n.scroller.setAttribute("lastupdate",l)},this.pullUpCallBack=function(e,t){var n=e.scroll;_=!1,F[e.index]=!1;var l=n.scroller.getAttribute("page");l||(l=0),n.scroller.setAttribute("page",parseInt(l)+1),"undefined"!=typeof t?(n.scroller.setAttribute("loadedAll","1"),a(n,x.pullUp.contentNomore),s(n,3),setTimeout(function(){r(n,0),s(n,0),n.refresh()},1e3)):setTimeout(function(){a(n,x.pullUp.contentUp),s(n,0),r(n,0),s(n,0),n.refresh()},1e3)};var Z=function(e){var t,n=j=0,l={},o=function(e,t,n,l){return-n*(e/=l)*(e-2)+t};return l.execution=function(i,r,p){var u=(new Date).getTime(),c=p||500,a=parseInt(e.style[i])||0,s=r-a;!function(){var r=(new Date).getTime()-u;return r>c?(r=c,e.style[i]=o(r,a,s,c)+"px",++n==j&&t&&t.apply(e),l):(e.style[i]=o(r,a,s,c)+"px",void setTimeout(arguments.callee,10))}()},l.animate=function(e,n,o){t=o;for(var i in e)j++,l.execution(i,parseInt(e[i]),n)},l};return U(e,t,n),this.upAction=x.pullUp.callback,this.downAction=x.pullDown.callback,this.upAnimation=x.pullUp.animation,this.downAnimation=x.pullDown.animation,this.upTip=x.pullUp.tip,this.downTip=x.pullDown.tip,this.slideAction=x.slide,this.config=x,this.refresh=function(e){G[e].refresh()},this.setPage=function(e,t){"number"!=typeof t&&(t=1),G[e].scroller.setAttribute("page",t)},this.setNoMore=function(e){G[e].scroller.setAttribute("nomore",1)},this.setLoadedAll=function(e){G[e].scroller.setAttribute("loadedAll",1)},this.getDownTip=function(e){return c(G[e])},this.getUpTip=function(){return f(G[index])},this.slide=function(e,t){x.slide=e,"undefined"==typeof t&&e(N.currentPage.pageX)},this.bdScroll=N,this.bdScrolls=G,this.tabScroll=A,this};n.exports=o});