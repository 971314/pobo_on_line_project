function setComboHash(t){var o=t.length;if(!(o<2)){data.comboSyntax&&(comboSyntax=data.comboSyntax),data.comboMaxLength&&(comboMaxLength=data.comboMaxLength),data.comboSuffix&&(comboSuffix=data.comboSuffix),comboExcludes=data.comboExcludes;for(var a=[],e=0;e<o;e++){var s=t[e];if(!comboHash[s]){var r=Module.get(s);r.status<FETCHING&&!isExcluded(s)&&!isComboUri(s)&&a.push(s)}}a.length>1&&paths2hash(uris2paths(a))}}function setRequestUri(t){t.requestUri=comboHash[t.uri]||t.uri}function uris2paths(t){return meta2paths(uris2meta(t))}function uris2meta(t){for(var o={__KEYS:[]},a=0,e=t.length;a<e;a++)for(var s=t[a].replace("://","__").split("/"),r=o,n=0,h=s.length;n<h;n++){var u=s[n];r[u]||(r[u]={__KEYS:[]},r.__KEYS.push(u)),r=r[u]}return o}function meta2paths(t){for(var o=[],a=t.__KEYS,e=0,s=a.length;e<s;e++){for(var r=a[e],n=r,h=t[r],u=h.__KEYS;1===u.length;)n+="/"+u[0],h=h[u[0]],u=h.__KEYS;u.length&&o.push([n.replace("__","://"),meta2arr(h)])}return o}function meta2arr(t){for(var o=[],a=t.__KEYS,e=0,s=a.length;e<s;e++){var r=a[e],n=meta2arr(t[r]),h=n.length;if(h)for(var u=0;u<h;u++)o.push(r+"/"+n[u]);else o.push(r)}return o}function paths2hash(t){for(var o=0,a=t.length;o<a;o++)for(var e=t[o],s=e[0]+"/",r=files2group(e[1]),n=0,h=r.length;n<h;n++)setHash(s,r[n]);return comboHash}function setHash(t,o){for(var a=[],e=0,s=o.length;e<s;e++)a[e]=o[e].replace(/\?.*$/,"");var r=t+comboSyntax[0]+a.join(comboSyntax[1]);comboSuffix&&(r+=comboSuffix);var n=r.length>comboMaxLength;if(o.length>1&&n){var h=splitFiles(o,comboMaxLength-(t+comboSyntax[0]).length);setHash(t,h[0]),setHash(t,h[1])}else{if(n)throw new Error("The combo url is too long: "+r);for(var e=0,s=o.length;e<s;e++)comboHash[t+o[e]]=r}}function splitFiles(t,o){for(var a=comboSyntax[1],e=t[0],s=1,r=t.length;s<r;s++)if(e+=a+t[s],e.length>o)return[t.splice(0,s),t]}function files2group(t){for(var o=[],a={},e=0,s=t.length;e<s;e++){var r=t[e],n=getExt(r);n&&(a[n]||(a[n]=[])).push(r)}for(var h in a)a.hasOwnProperty(h)&&o.push(a[h]);return o}function getExt(t){var o=t.lastIndexOf(".");return o>=0?t.substring(o):""}function isExcluded(t){if(comboExcludes)return comboExcludes.test?comboExcludes.test(t):comboExcludes(t)}function isComboUri(t){var o=data.comboSyntax||["??",","],a=o[0],e=o[1];return a&&t.indexOf(a)>0||e&&t.indexOf(e)>0}var Module=seajs.Module,FETCHING=Module.STATUS.FETCHING,data=seajs.data,comboHash=data.comboHash={},comboSyntax=["??",","],comboMaxLength=2e3,comboExcludes,comboSuffix;if(seajs.on("load",setComboHash),seajs.on("fetch",setRequestUri),data.test){var test=seajs.test||(seajs.test={});test.uris2paths=uris2paths,test.paths2hash=paths2hash}