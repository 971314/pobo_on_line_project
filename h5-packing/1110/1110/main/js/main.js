function decimalDecPrice(e,t){t+="";var n=t.indexOf("."),a=t.length;return n>=0&&a-1-n>=e?t.substr(0,t.indexOf(".")+e+1):(t-0).toFixed(e)}function showCon(){var e=mainConfig.contracts,t=e.data;if(isPoboApp){var n;if(e.useHistory){if(n=pbSYS.getHomeThreeContracts()){if(n=JSON.parse(n),n.length>0&&n.length<3)for(var a=t.length-1;a>=0;a--){for(var r=!1,i=0;i<n.length;i++)if(t[a].code==n[i].code){r=!0;break}if(r||n.unshift(t[a]),3==n.length)break}n.length>0&&(t=n)}}else e.self||e.hot}if(!contract||contract.length!=t.length){for(var c="",a=0;a<t.length;a++)a%3==0&&(c+='<div class="marketCon clearfix'+(a?"":" active")+'">'),c+='<div class="col-xs-4 market text-center"><a id="market-href-'+a+'"><p class="e1"><span id="market-name-'+a+'" class="market-name"></span></p><p class="a1 m" id="market-price-'+a+'"><img src=""> <span>--</span></p><p class="e1 m" id="market-chg-'+a+'"><span>--</span>&nbsp;&nbsp;<span>--</span></p></a></div>',a%3!=2&&a!=t.length-1||(c+="</div>");$("#market").html(c)}for(var o=[],a=0;a<t.length;a++)if(o.push({2:t[a].market,3:t[a].code}),!isPoboApp){$("#market-name-"+a).html(t[a].name);var i=a%3;1!=i&&($("#market-href-"+a).addClass(i<1?"down":"up"),$("#market-price-"+a+" img").attr("src","../images/"+(i<1?"low":"high")+".png")),$("#market-price-"+a+" span").html(decimalDecPrice(4,Math.random()));var s=$("#market-chg-"+a+" span");s[0].innerHTML=decimalDecPrice(2,Math.random())*(i-1),s[1].innerHTML=decimalDecPrice(2,Math.random())*(i-1)+"%"}contract=t,isPoboApp&&pbHQ.hqSubscribe(0,JSON.stringify({1:o})),t.length<4&&contractInterval&&(clearInterval(contractInterval),contractInterval=null),t.length>3&&!contractInterval&&(contractInterval=setInterval(function(){var e=$("#market .marketCon"),t=e.filter(".active").removeClass("active").index();++t>=e.length&&(t=0),e.eq(t).addClass("active")},1e4))}function callback(e){var t=JSON.parse(e);if(90004==t.moduleId)newsData[newsCurrent]=t.jData.Indexes.slice(0,mainConfig.news.data[newsCurrent].count),ReactDOM.render(React.createElement(InfoList,{contents:newsData[newsCurrent],dir:dirStr}),document.getElementById("info-list"));else if(9e4==t.moduleId){for(var n=t.jData.Data,a=0;a<contract.length;a++){var r=0,i=pbHQ.hqGetPriceRate(contract[a].code,contract[a].market),c=JSON.parse(pbHQ.hqGetZDInfo(contract[a].code,contract[a].market));contract[a].zd=c.HQZD,contract[a].zdf=c.HQZDF,contract[a].groupflag=pbHQ.hqGetGroupFlag(contract[a].code,contract[a].market),contract[a].decimal=pbHQ.hqGetPriceDecimal(contract[a].code,contract[a].market);for(var o=0;o<n.length;o++)if(contract[a].code==n[o][10]){n[o][29]?(r=(n[o][29]-0)/i,contract[a].price=decimalDecPrice(contract[a].decimal,r)):contract[a].price="--";break}void 0==contract[a].price&&(contract[a].price="--")}for(var a=0;a<contract.length;a++){var s=$("#market-href-"+a).attr("href","pobo:uncheck=1&pageId=801001&market="+contract[a].market+"&code="+contract[a].code+"&groupflag="+contract[a].groupflag+"&hideflag=1").removeClass(),l=$("#market-price-"+a),d=l.find("img"),m=$("#market-chg-"+a+" span");isNaN(contract[a].zd)||(contract[a].zd>0?(s.addClass("up"),d.attr("src","../images/high.png")):contract[a].zd<0?(s.addClass("down"),d.attr("src","../images/low.png")):contract[a].zdf="0%"),m[0].innerHTML=contract[a].zd,m[1].innerHTML=contract[a].zdf,l.find("span").html(contract[a].price),$("#market-name-"+a).html(contract[a].name)}}}function processCustom(){var e=mainConfig.customs,t=e;if(isPoboApp)if(pbSYS.isHasLocalFile("main",1))if(t=pbSYS.readLocalFile("main",1)){if(t=JSON.parse(t),!t.version||!t.checkedVer||t.version<e.version)prevCustom=null,pbSYS.writeLocalFile("main",1,JSON.stringify(t=e));else if(t.version==e.version&&t.checkedVer<e.checkedVer){for(var n=0;n<t.contents.length;n++)for(var a=0;a<e.contents.length;a++){var r=t.contents[n],i=e.contents[a];if(r.id==i.id){r.title==i.title&&r.image1==i.image1&&r.image2==i.image2&&r.url==i.url||(i.checked="0",t.contents[n]=i);break}}pbSYS.writeLocalFile("main",1,JSON.stringify(t))}}else pbSYS.writeLocalFile("main",1,JSON.stringify(t=e));else pbSYS.writeLocalFile("main",1,JSON.stringify(t=e));for(var c=[],n=0;n<t.contents.length;n++)"1"==t.contents[n].checked&&c.push(t.contents[n]);var o=c.length,s=Math.ceil((o+1)/8);if(prevCustom&&prevCustom.length==o){for(var n=0;n<o&&prevCustom[n].id==c[n].id;n++);if(n==o)return}prevCustom=c,ReactDOM.render(React.createElement(CustButton,{button:c}),document.getElementById("customized"));var l=$("#indicator"),d="";if(s>1)for(var n=0;n<s;n++)d+="<li"+(n?"":' class="ind"')+"></li> ";l.html(d);var m=document.documentElement.clientWidth;$("#customized .area>div").css({width:m}),s<2?$("#customized .area").attr("style",""):$("#customized .area").css("width",m*s),navScroll&&navScroll.destroy(),s>1&&(l=l.find("li"),navScroll=new IScroll("#customized",{eventPassthrough:!0,scrollX:!0,scrollY:!1,preventDefault:!1,snap:".btn-wrap",tap:!0,mouseWheelSpeed:10}),navScroll.on("scrollEnd",function(){l.removeClass().eq(Math.floor(-this.x/m)).addClass("ind")}))}function queryNews(e){if(isPoboApp)pbINFO.infoQueryListWithJson(JSON.stringify({type:"mu",groupIDs:e.ids,doc:"json",count:e.count}));else{for(var t={gcount:e.ids.length,count:e.count},n=0;n<t.gcount;n++)t["group"+(n+1)]=e.ids[n];$.get(mainConfig.news.webservice,t,function(t){newsData[newsCurrent]=JSON.parse(t).Indexes.slice(0,e.count),ReactDOM.render(React.createElement(InfoList,{contents:newsData[newsCurrent]}),document.getElementById("info-list"))})}}function processConfig(e){if(mainConfig&&(prevConfig=mainConfig),mainConfig=e,prevConfig&&prevConfig.version!=e.version)return void location.reload();var t=e.banners,n=$("#carousel-example-generic");if(!prevConfig||prevConfig.banners.version!=t.version)if(t.isShow){n.show();var a="",r="";t.data.forEach(function(e,t){a+="<a class='item"+(t?"":" active")+"'"+(e.url?" href='"+e.url+"'":"")+"><img src='"+e.img+"'/></a>",r+="<li data-target='#carousel-example-generic' data-slide-to='"+t+"'"+(t?"":" class='active'")+"></li> "}),window.bannersInit?(n.carousel("pause"),setTimeout(function(){n.find(".carousel-inner").html(a),n.find(".carousel-indicators").html(r),n.carousel("cycle")},1e3)):(n.find(".carousel-inner").html(a),n.find(".carousel-indicators").html(r),bannersInit=!0)}else n.hide();if(e.contracts.isShow?($("#market").show(),showCon()):($("#market").hide(),contractInterval&&(clearInterval(contractInterval),contractInterval=null)),e.customs.isShow?($("#customContainer").show(),processCustom()):$("#customContainer").hide(),t=e.news,n=$("#info"),!prevConfig||prevConfig.news.version!=t.version)if(t.isShow){n.show();var a="";t.data.forEach(function(e){a+="<i>"+e.name+"</i>"}),n.find(".area-title span").html(a),newsCurrent=0,t.data.length>1&&n.find(".area-title i").on("click",function(){var e=$(this),n=e.index();e.addClass("active").siblings().removeClass(),newsCurrent=n,newsData[n]?ReactDOM.render(React.createElement(InfoList,{contents:newsData[n],dir:"pobo:info/"}),document.getElementById("info-list")):queryNews(t.data[n])}).eq(0).addClass("active")}else n.hide();t.isShow&&t.data.length>0&&(newsData=[],queryNews(t.data[newsCurrent]))}function reload(){isPoboApp?processConfig(JSON.parse(pbSYS.readConfig("main/conf/main.json"))):$.get("conf/main.json?"+Date.now(),processConfig)}var CustButton=React.createClass({displayName:"CustButton",render:function(){for(var e=this.props.button,t=Math.ceil((e.length+1)/8),n=[],a=function(e){var t={backgroundImage:"url(images/"+e.image1+")"};return React.createElement("div",null,React.createElement("a",{className:"btn btn-default",style:t,href:e.url,id:e.id},e.title))},r=function(e){return e.length<8&&e.push({image1:"gengduo.png",url:"pobo:uncheck=1&pageId=900005&url=main/view/index-add.html",id:"",title:"添加"}),e.map(a)},i=0;i<t;i++)n.push(React.createElement("div",{className:"btn-wrap clearfix"},r(e.slice(8*i,8*i+8))));return React.createElement("div",{className:"area clearfix"},n)}}),InfoList=React.createClass({displayName:"InfoList",getDefaultProps:function(){return{dir:""}},render:function(){var e=function(e){var t=this.props.dir+"info/view/info-de.html?newsId="+e.ID,n=e.Pubtime.split(" ");return React.createElement("a",{className:"list-group-item clearfix",href:t},React.createElement("span",{className:"title",dangerouslySetInnerHTML:{__html:e.Title}}),React.createElement("span",{className:"time"},n[0]))};return React.createElement("div",{className:"list-group"},this.props.contents.map(e,this))}}),isPoboApp="undefined"!=typeof pbE,contract,contractInterval,prevCustom,navScroll,newsData,newsCurrent,mainConfig,prevConfig,dirStr="pobo:uncheck=1&pageId=904002&url=";if(isPoboApp)var pbHQ=pbE.HQ(),pbSYS=pbE.SYS(),pbINFO=pbE.INFO();reload();