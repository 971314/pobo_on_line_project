function GetQueryString(e){var r=decodeURI(window.location.search.substr(1)),t=new RegExp("(^|&)"+e+"=([^&]*)(&|$)"),o=r.match(t);return o?unescape(o[2]):null}function isPhoneNum(e){var r=!!e.match(/^[0-9]{11}$/);return r}function isRightPwd(e){var r=!!e.match(/^(?!\D+$)(?!\d+$)[a-zA-Z0-9]{6,16}$/);return r}function isNull(e){return 0==$.trim(e).length}function sendOTPBtn(e){var r=e,t=setInterval(function(){0==r?($("#btn-send").removeClass("disabled"),$("#btn-send").val("获取校验码"),clearInterval(t)):($("#btn-send").val("("+r+"S)"),$("#btn-send").addClass("disabled")),r--},1e3)}function sendRegOTP(){var e=$.trim($("#phone").val());if("undefined"!=typeof pbE)if(isPhoneNum(e)){if($("#btn-send")[0]){var r=(new Date).getTime(),t=pbE.SYS().getPrivateData("sendOTPTime");if(t){var o=r-t;if(o>1e3*testTiem)$.ajax({type:"POST",url:serverAddr+"firstregister",timeout:3e4,data:{poboNumber:poboNumber,loginName:e,loginType:loginType,deviceId:deviceId,pwd:"",FatherAccount:FatherAccount,OS:OS,version:version,orgNumber:orgNumber},dataType:"json",success:function(t){0==t.loginUser.returnFlag?(sendOTPBtn(testTiem),pbE.SYS().storePrivateData("sendOTPTime",r+""),$(".error").addClass("hide"),$(".registered").addClass("hide")):5==t.loginUser.returnFlag?($(".error").addClass("hide").empty(),$(".registered").removeClass("hide"),$(".registered a").attr("href","reg-pwd.html?phone="+e)):($(".registered").addClass("hide"),alert("发送失败，请稍后重试"))},error:function(e,r,t){$("#backdrop").addClass("hide"),(r="error")?alert("连接超时，请检查网络后重试"):(r="timeout")&&alert("连接超时，请稍后再试")}});else var a=testTiem-Math.round(o/1e3),i=setInterval(function(){return 0==a?($("#btn-send").removeClass("disabled"),$("#btn-send").val("获取校验码"),void clearInterval(i)):($("#btn-send").val("("+a+"S)"),$("#btn-send").addClass("disabled"),void a--)},1e3)}else $.ajax({type:"POST",url:serverAddr+"firstregister",timeout:3e4,data:{poboNumber:poboNumber,loginName:e,loginType:loginType,deviceId:deviceId,pwd:"",FatherAccount:FatherAccount,OS:OS,version:version,orgNumber:orgNumber},dataType:"json",success:function(t){0==t.loginUser.returnFlag?(sendOTPBtn(testTiem),pbE.SYS().storePrivateData("sendOTPTime",r+""),$(".error").addClass("hide"),$(".registered").addClass("hide")):5==t.loginUser.returnFlag?($(".error").addClass("hide").empty(),$(".registered").removeClass("hide"),$(".registered a").attr("href","reg-pwd.html?phone="+e)):($(".registered").addClass("hide"),alert("发送失败，请稍后重试"))},error:function(e,r,t){$("#backdrop").addClass("hide"),(r="error")?alert("连接超时，请检查网络后重试"):(r="timeout")&&alert("连接超时，请稍后再试")}})}}else alert("请输入正确的手机号"),$("#phone").focus();else if(isPhoneNum(e)){if($("#btn-send")[0]){var r=(new Date).getTime(),t=localStorage.getItem("sendOTPTime");if(t){var o=r-t;if(o>1e3*testTiem)$.ajax({type:"POST",url:serverAddr+"firstregister",timeout:3e4,data:{poboNumber:poboNumber,loginName:e,loginType:loginType,deviceId:deviceId,pwd:"",FatherAccount:FatherAccount,OS:OS,version:version,orgNumber:orgNumber},dataType:"json",success:function(t){0==t.loginUser.returnFlag?(sendOTPBtn(testTiem),localStorage.setItem("sendOTPTime",r+""),$(".error").addClass("hide"),$(".registered").addClass("hide")):5==t.loginUser.returnFlag?($(".error").addClass("hide").empty(),$(".registered").removeClass("hide"),$(".registered a").attr("href","reg-pwd.html?phone="+e)):($(".registered").addClass("hide"),alert("发送失败，请稍后重试"))},error:function(e,r,t){$("#backdrop").addClass("hide"),(r="error")?alert("连接超时，请检查网络后重试"):(r="timeout")&&alert("连接超时，请稍后再试")}});else var a=testTiem-Math.round(o/1e3),i=setInterval(function(){return 0==a?($("#btn-send").removeClass("disabled"),$("#btn-send").val("获取校验码"),void clearInterval(i)):($("#btn-send").val("("+a+"S)"),$("#btn-send").addClass("disabled"),void a--)},1e3)}else $.ajax({type:"POST",url:serverAddr+"firstregister",timeout:3e4,data:{poboNumber:poboNumber,loginName:e,loginType:loginType,deviceId:deviceId,pwd:"",FatherAccount:FatherAccount,OS:OS,version:version,orgNumber:orgNumber},dataType:"json",success:function(t){0==t.loginUser.returnFlag?(sendOTPBtn(testTiem),localStorage.setItem("sendOTPTime",r+""),$(".error").addClass("hide"),$(".registered").addClass("hide")):5==t.loginUser.returnFlag?($(".error").addClass("hide").empty(),$(".registered").removeClass("hide"),$(".registered a").attr("href","reg-pwd.html?phone="+e)):($(".registered").addClass("hide"),alert("发送失败，请稍后重试"))},error:function(e,r,t){$("#backdrop").addClass("hide"),(r="error")?alert("连接超时，请检查网络后重试"):(r="timeout")&&alert("连接超时，请稍后再试")}})}}else alert("请输入正确的手机号"),$("#phone").focus()}function sendPwdOTP(){var e=$.trim($("#phone").val());if("undefined"!=typeof pbE)if(isPhoneNum(e)){if($("#btn-send")[0]){var r=(new Date).getTime(),t=pbE.SYS().getPrivateData("sendOTPTime");if(t){var o=r-t;if(o>1e3*testTiem)$.ajax({type:"POST",url:serverAddr+"getOtp",timeout:3e4,data:{poboNumber:poboNumber,loginName:e,loginType:loginType,deviceId:deviceId,orgNumber:orgNumber},dataType:"json",success:function(e){0==e.findByPhone.returnFlag?(sendOTPBtn(testTiem),pbE.SYS().storePrivateData("sendOTPTime",r+""),$(".error").addClass("hide"),userId=e.findByPhone.userId):11==e.findByPhone.returnFlag?alert("该用户尚未注册"):alert("发送失败，请稍后重试")},error:function(e,r,t){$("#backdrop").addClass("hide"),(r="error")?alert("连接超时，请检查网络后重试"):(r="timeout")&&alert("连接超时，请稍后再试")}});else var a=testTiem-Math.round(o/1e3),i=setInterval(function(){return 0==a?($("#btn-send").removeClass("disabled"),$("#btn-send").val("获取校验码"),void clearInterval(i)):($("#btn-send").val("("+a+"S)"),$("#btn-send").addClass("disabled"),void a--)},1e3)}else $.ajax({type:"POST",url:serverAddr+"getOtp",timeout:3e4,data:{poboNumber:poboNumber,loginName:e,loginType:loginType,deviceId:deviceId,orgNumber:orgNumber},dataType:"json",success:function(e){0==e.findByPhone.returnFlag?(sendOTPBtn(testTiem),pbE.SYS().storePrivateData("sendOTPTime",r+""),$(".error").addClass("hide"),userId=e.findByPhone.userId):11==e.findByPhone.returnFlag?alert("该用户尚未注册"):alert("发送失败，请稍后重试")},error:function(e,r,t){$("#backdrop").addClass("hide"),(r="error")?alert("连接超时，请检查网络后重试"):(r="timeout")&&alert("连接超时，请稍后再试")}})}}else alert("请输入正确的手机号"),$("#phone").focus();else if(isPhoneNum(e)){if($("#btn-send")[0]){var r=(new Date).getTime(),t=localStorage.getItem("sendOTPTime");if(t){var o=r-t;if(o>1e3*testTiem)$.ajax({type:"POST",url:serverAddr+"getOtp",timeout:3e4,data:{poboNumber:poboNumber,loginName:e,loginType:loginType,deviceId:deviceId,orgNumber:orgNumber},dataType:"json",success:function(e){0==e.findByPhone.returnFlag?(sendOTPBtn(testTiem),localStorage.setItem("sendOTPTime",r+""),$(".error").addClass("hide"),userId=e.findByPhone.userId):11==e.findByPhone.returnFlag?alert("该用户尚未注册"):alert("发送失败，请稍后重试")},error:function(e,r,t){$("#backdrop").addClass("hide"),(r="error")?alert("连接超时，请检查网络后重试"):(r="timeout")&&alert("连接超时，请稍后再试")}});else var a=testTiem-Math.round(o/1e3),i=setInterval(function(){return 0==a?($("#btn-send").removeClass("disabled"),$("#btn-send").val("获取校验码"),void clearInterval(i)):($("#btn-send").val("("+a+"S)"),$("#btn-send").addClass("disabled"),void a--)},1e3)}else $.ajax({type:"POST",url:serverAddr+"getOtp",timeout:3e4,data:{poboNumber:poboNumber,loginName:e,loginType:loginType,deviceId:deviceId,orgNumber:orgNumber},dataType:"json",success:function(e){0==e.findByPhone.returnFlag?(sendOTPBtn(testTiem),pbE.SYS().storePrivateData("sendOTPTime",r+""),$(".error").addClass("hide"),userId=e.findByPhone.userId):11==e.findByPhone.returnFlag?alert("该用户尚未注册"):alert("发送失败，请稍后重试")},error:function(e,r,t){$("#backdrop").addClass("hide"),(r="error")?alert("连接超时，请检查网络后重试"):(r="timeout")&&alert("连接超时，请稍后再试")}})}}else alert("请输入正确的手机号"),$("#phone").focus()}function register(){var e=$.trim($("#phone").val()),r=$.trim($("#code").val()),t=$.trim($("#pwdInit").val()),o=$.trim($("#confirm").val());if("undefined"!=typeof pbE)if(isPhoneNum(e)){if(isNull(r))return alert("请输入验证码"),$("#code").focus(),!1;if(isNull(t))return alert("请输入密码"),$("#pwdInit").focus(),!1;if(!isRightPwd(t))return alert("密码是6-16位字母和数字的组合"),$("#pwdInit").focus(),!1;if(isNull(o))return alert("请输入确认密码"),$("#confirm").focus(),!1;if(o!=t)return alert("两次输入密码不一致"),$("#confirm").focus(),!1;if(0==ht.checked)return alert("请选择注册协议"),!1;$("#backdrop").removeClass("hide"),$.ajax({type:"POST",url:serverAddr+"checkRegister",timeout:3e4,data:{poboNumber:poboNumber,loginName:e,loginType:loginType,OTP:r,deviceId:deviceId,pwd:t,orgNumber:orgNumber},dataType:"json",success:function(r){$("#backdrop").addClass("hide"),0==r.checkOTP.returnFlag?($(".error").addClass("hide"),$(".registered").addClass("hide"),delete r.checkOTP.returnFlag,r.checkOTP.pwd=t,r.checkOTP.loginName=e,r.checkOTP.loginType=loginType,pbE.SYS().sendMessageToNative("PbKey_H5_Home_Auth_Data",JSON.stringify(r.checkOTP))):5==r.checkOTP.returnFlag?($(".error").addClass("hide").empty(),$(".registered").removeClass("hide"),$(".registered a").attr("href","reg-pwd.html?phone="+e)):8==r.checkOTP.returnFlag?($(".registered").addClass("hide"),alert("校验码错误，请重新获取")):($(".registered").addClass("hide"),alert("发送失败，请稍后重试"))},error:function(e,r,t){$("#backdrop").addClass("hide"),(r="error")?alert("连接超时，请检查网络后重试"):(r="timeout")&&alert("连接超时，请稍后再试")}})}else alert("请输入正确的手机号"),$("#phone").focus();else if(isPhoneNum(e)){if(isNull(r))return alert("请输入验证码"),$("#code").focus(),!1;if(isNull(t))return alert("请输入密码"),$("#pwdInit").focus(),!1;if(!isRightPwd(t))return alert("密码是6-16位字母和数字的组合"),$("#pwdInit").focus(),!1;if(isNull(o))return alert("请输入确认密码"),$("#confirm").focus(),!1;if(o!=t)return alert("两次输入密码不一致"),$("#confirm").focus(),!1;if(0==ht.checked)return alert("请选择注册协议"),!1;$("#backdrop").removeClass("hide"),$.ajax({type:"POST",url:serverAddr+"checkRegister",timeout:3e4,data:{poboNumber:poboNumber,loginName:e,loginType:loginType,OTP:r,deviceId:deviceId,pwd:t,orgNumber:orgNumber},dataType:"json",success:function(r){$("#backdrop").addClass("hide"),0==r.checkOTP.returnFlag?($(".error").addClass("hide"),$(".registered").addClass("hide"),delete r.checkOTP.returnFlag,r.checkOTP.pwd=e.substr(-6),r.checkOTP.loginName=e,r.checkOTP.loginType=loginType,window.location.href="reg-regsuc.html"):5==r.checkOTP.returnFlag?($(".error").addClass("hide").empty(),$(".registered").removeClass("hide"),$(".registered a").attr("href","reg-pwd.html?phone="+e)):8==r.checkOTP.returnFlag?($(".registered").addClass("hide"),alert("校验码错误，请重新获取")):($(".registered").addClass("hide"),alert("发送失败，请稍后重试"))},error:function(e,r,t){$("#backdrop").addClass("hide"),(r="error")?alert("连接超时，请检查网络后重试"):(r="timeout")&&alert("连接超时，请稍后再试")}})}else alert("请输入正确的手机号"),$("#phone").focus()}function setPwd(){var e=$.trim($("#phone").val()),r=$.trim($("#code").val()),t=$.trim($("#password").val()),o=$.trim($("#confirm").val());if("undefined"!=typeof pbE)if(isPhoneNum(e)){if(isNull(r))return alert("请请输入验证码"),$("#code").focus(),!1;if(isNull(t))return alert("请输入密码"),$("#password").focus(),!1;if(!isRightPwd(t))return alert("密码是6-16位字母和数字的组合"),$("#password").focus(),!1;if(isNull(o))return alert("请输入确认密码"),$("#confirm").focus(),!1;if(o!=t)return alert("两次输入密码不一致"),$("#confirm").focus(),!1;$("#backdrop").removeClass("hide"),$.ajax({type:"POST",url:serverAddr+"changePwd",timeout:3e4,data:{poboNumber:poboNumber,loginName:e,loginType:loginType,pwd:t,uid:userId,orgNumber:orgNumber,deviceId:deviceId,OS:OS,version:version,OTP:r},dataType:"json",success:function(r){$("#backdrop").addClass("hide"),0==r.loginUser.returnFlag?($(".error").addClass("hide"),delete r.loginUser.returnFlag,r.loginUser.pwd=t,r.loginUser.loginName=e,r.loginUser.loginType=loginType,pbE.SYS().sendMessageToNative("PbKey_H5_Home_Auth_Data",JSON.stringify(r.loginUser))):8==r.loginUser.returnFlag?alert("校验码错误，请重新获取"):11==r.loginUser.returnFlag?alert("该用户尚未注册"):alert("发送失败，请稍后重试")},error:function(e,r,t){$("#backdrop").addClass("hide"),(r="error")?alert("连接超时，请检查网络后重试"):(r="timeout")&&alert("连接超时，请稍后再试")}})}else alert("请输入正确的手机号"),$("#phone").focus();else if(isPhoneNum(e)){if(isNull(r))return alert("请请输入验证码"),$("#code").focus(),!1;if(isNull(t))return alert("请输入密码"),$("#password").focus(),!1;if(!isRightPwd(t))return alert("密码是6-16位字母和数字的组合"),$("#password").focus(),!1;if(isNull(o))return alert("请输入确认密码"),$("#confirm").focus(),!1;if(o!=t)return alert("两次输入密码不一致"),$("#confirm").focus(),!1;$("#backdrop").removeClass("hide"),ajaxTimeoutTest=$.ajax({type:"POST",url:serverAddr+"changePwd",timeout:3e4,data:{poboNumber:poboNumber,loginName:e,loginType:loginType,pwd:t,uid:userId,orgNumber:orgNumber,deviceId:deviceId,OS:OS,version:version,OTP:r},dataType:"json",success:function(r){$("#backdrop").addClass("hide"),0==r.loginUser.returnFlag?($(".error").addClass("hide"),delete r.loginUser.returnFlag,r.loginUser.pwd=t,r.loginUser.loginName=e,r.loginUser.loginType=loginType,location.href="reg-pwdsuc.html"):8==r.loginUser.returnFlag?alert("校验码错误，请重新获取"):11==r.loginUser.returnFlag?alert("该用户尚未注册"):alert("发送失败，请稍后重试")},error:function(e,r,t){$("#backdrop").addClass("hide"),(r="error")?alert("连接超时，请检查网络后重试"):(r="timeout")&&alert("连接超时，请稍后再试")}})}else alert("请输入正确的手机号"),$("#phone").focus()}function login(){var e=$.trim($("#phone").val()),r=$.trim($("#password").val());if("undefined"!=typeof pbE)if(isPhoneNum(e)){if(isNull(r))return alert("请输入密码"),$("#password").focus(),!1;$("#backdrop").removeClass("hide"),$.ajax({type:"POST",url:serverAddr+"login",timeout:3e4,data:{poboNumber:poboNumber,loginName:e,loginType:loginType,pwd:r,orgNumber:orgNumber,deviceId:deviceId,OS:OS,version:version},dataType:"json",success:function(t){$("#backdrop").addClass("hide"),0==t.loginUser.returnFlag?($(".error").addClass("hide"),delete t.loginUser.returnFlag,t.loginUser.pwd=r,t.loginUser.loginName=e,t.loginUser.loginType=loginType,pbE.SYS().sendMessageToNative("PbKey_H5_Home_Auth_Data",JSON.stringify(t.loginUser))):2==t.loginUser.returnFlag?(alert("账号或密码有误，请修改后重试"),$("#phone").focus()):alert("发送失败，请稍后重试")},error:function(e,r,t){$("#backdrop").addClass("hide"),(r="error")?alert("连接超时，请检查网络后重试"):(r="timeout")&&alert("连接超时，请稍后再试")}})}else alert("请输入正确的手机号"),$("#phone").focus();else if(isPhoneNum(e)){if(isNull(r))return alert("请输入密码"),$("#password").focus(),!1;$("#backdrop").removeClass("hide"),$.ajax({type:"POST",url:serverAddr+"login",timeout:3e4,data:{poboNumber:poboNumber,loginName:e,loginType:loginType,pwd:r,orgNumber:orgNumber,deviceId:deviceId,OS:OS,version:version},dataType:"json",success:function(t){$("#backdrop").addClass("hide"),0==t.loginUser.returnFlag?($(".error").addClass("hide"),delete t.loginUser.returnFlag,t.loginUser.pwd=r,t.loginUser.loginName=e,t.loginUser.loginType=loginType,location.href="../../main/index.html"):2==t.loginUser.returnFlag?(alert("账号或密码有误，请修改后重试"),$("#phone").focus()):alert("发送失败，请稍后重试")},error:function(e,r,t){$("#backdrop").addClass("hide"),(r="error")?alert("连接超时，请检查网络后重试"):(r="timeout")&&alert("连接超时，请稍后再试")}})}else alert("请输入正确的手机号"),$("#phone").focus()}function jump(e){var r=document.getElementById(e),t=arguments.callee.caller.arguments[0]||window.event;13==t.keyCode&&r.focus()}function fold(){$("input").blur()}function goBack(){"undefined"!=typeof pbE?location.href="goBack":location.href=document.referrer}var serverAddr="https://pbmobile.pobo.net.cn/pobocertification_WebService/",u=navigator.userAgent,isAndroid=u.indexOf("Android")>-1||u.indexOf("Linux")>-1;isAndroid&&document.write("<style>body{padding-top: 48px;} .navbar-fixed-top{min-height: 48px;} .navbar .navbar-brand{height: 48px; padding: 15px;} .navbar .navbar-text{line-height: 48px;}</style>");var loginType="1",userId,poboNumber="123",deviceId="127.0.0.1",FatherAccount="pobo",OS="iOS",version="1.0.0",orgNumber="789",testTiem=120,ajaxTimeoutTest;if("undefined"!=typeof pbE){var deviceInfo1=pbE.SYS().getDeviceJsonInfo();if(deviceInfo1){var deviceInfo=JSON.parse(deviceInfo1);if(deviceInfo[71]&&(deviceId=deviceInfo[71]),deviceInfo[255]){var platNum=deviceInfo[255];"2"==platNum?OS="iOS":"3"==platNum&&(OS="Android")}deviceInfo[73]&&(version=deviceInfo[73]),deviceInfo.jgid&&(orgNumber=deviceInfo.jgid)}}